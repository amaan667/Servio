# Nixpacks configuration for Railway
# IMPORTANT: Metal builds must be DISABLED in Railway Dashboard
# Go to Settings > Build > Turn OFF "Metal Builds"
# Metal builds are NOT ready for production and will cause deployments to be skipped

# Pin to specific nixpkgs version to ensure consistency
nixpkgsArchive = "23f9169c4ccce521379e602cc82ed873a1f1b52b"

[phases.setup]
# Use nodejs-20_x (underscore instead of dash for version)
nixPkgs = ["nodejs-20_x"]

[phases.install]
cmds = ["corepack enable pnpm", "pnpm install --frozen-lockfile"]

[phases.build]
cmds = ["NODE_NO_WARNINGS=1 pnpm run build"]

[start]
cmd = "pnpm start"
