# Railway deployment configuration for Playwright
# Installs Chromium and required dependencies

[phases.setup]
# Install Chromium and dependencies needed for Playwright
nixPkgs = ["chromium", "nss", "freetype", "harfbuzz", "ca-certificates", "ttf-freefont", "fontconfig"]

[phases.install]
# Install Node dependencies and Playwright browsers
cmds = [
  "npm ci",
  "npx playwright install chromium --with-deps"
]

[phases.build]
cmds = ["npm run build"]

[start]
cmd = "npm start"

[variables]
# Playwright configuration for production
PLAYWRIGHT_SKIP_BROWSER_DOWNLOAD = "0"
PLAYWRIGHT_CHROMIUM_EXECUTABLE_PATH = "/usr/bin/chromium"
